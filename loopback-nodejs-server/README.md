## Loopback 'hello-node' app


### yack

reserve. If I am not logged in the app should prompt me to register. The app should tell me if the quantity is available and if so that my reservation has been made.

### Features

 - Authenticates and verifies the identity of military officials.
 - Securely exposes inventory data to mobile applications.
 - Allow users to find weapons and ammo available **within a specific area**.
 - Allow users to reserve weapons for rental.

### REST APIs

 - `/weapons` exposes a queryable (filter, sort) collection of available weapons over HTTP / JSON
 - `/weapons/nearby?&lat=...&long=... or ?zip=...` returns a filtered set of available weapons nearby the requesting user
 - `/weapons/nearby?id=24&zip=94555` returns nearby weapons of id 24.
 - `/weapons/:id` returns a specific weapon from the inventory, with specific pricing and images
 - `/users/login` allows a customer to login
 - `/users/logout` allows a customer to logout

[Here are some sample usages of the REST APIs](sample-api-usage.md)

### Browser JavaScript APIs

*Note: Similar APIs available in iOS, Android, etc.*

**Weapon** _inherits from LoopbackObject_

A class generated by loopback for working with weapon data.

_get weapons nearby_

    // weapons nearby
    var here = new Location();

    // custom `nearby` function
    Weapon.nearby(here, function (err, weapons) {
      console.log(weapons); // [...list of nearby weapons...]
    });
    
**RentalLocation** _inherits from Location (which is an LoopbackObject)_

A class generated by loopback for working with rental location data.

_get all weapon locations within an area_

    RentalLocation.getInRadius({lat: loc.lat, lng: loc.long, radius: 0.5}, function (err, locations) {
      console.log(locations); // [...list of locations...]
    });

**Reservation**

    var reservation = new Reservation();
    var me = User.getCurrentUser();

    if(me) {
      reservation.set({weapons: [1, 2, 3], customer: me});
      reservation.save();
    } else {
      console.log('user must login...');
    }
    
**User** _inherits from LoopbackObject_

A class generated by loopback for managing users.

    User.login({username: 'foo', password: 'bar'}, function(err, user) {
      console.log(user); // the currently logged in user
    });

    User.logout(); // logout current user

### Infrastructure

#### Customer Database

All customer information is available from the SalesForce api.

#### Inventory Database

All weapon inventory is already available in an **existing** Oracle X3-8 Exadata Database Machine in an extremely secure location.

The Inventory DB schema looks like this:

##### **Customers**
 - customer_id
 - name
 - country
 - military_agency
 
##### **Reservations**
 - status
 - customer_id
 - parent_reservation
 - product_id
 - product_qty
 - location_id
 - return_date
 
##### **Inventory_Levels**
 - product_id
 - inventory_date
 - location_id
 - qty_in_stock
 
##### **Products**
 - product_id
 - product_name
 - qty_in_stock
 
##### **Location**
 - location_id
 - address
 - city
 - state
 - name

##### **Inventory_View**

**View** to return qty of available products for the given city.

 - product (product name)
 - location (location name)
 - available (qty available)

#### Geo Lookup

Google's location API is used to return the users city from a given zip or lat/long.


### `/weapons`

**exposes a queryable (filter, sort) collection of available weapons over HTTP / JSON**


#### GET `/weapons`

**Request**

    Content-Type: application/json

**Response**

    200
    [
      {"id": 1, ...},
      {"id": 2, ...},
      {"id": 3, ...},
      {"id": 4, ...},
      {"id": 5, ...},
      ...
    ]
  
#### GET `/weapons?{"limit": 5, "qty": {"gt": 0}}`

**Request**

    Content-Type: application/json

**Response**

    200
    [
      {"id": 1, ...},
      {"id": 2, ...},
      {"id": 3, ...},
      {"id": 4, ...},
      {"id": 5, ...}
    ]

Queries may include anything in the following form:

    {
      where: {qty: {gt: 0}} // qty is > 0
      order: 'qty DESC',
      skip: 10,
      limit: 5
    }

